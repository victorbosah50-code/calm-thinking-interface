<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Calm Thinking ‚Äì A Therapeutic Space</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">

<style>
html,body{
  margin:0;
  height:100%;
  font-family:'Nunito',sans-serif;
  background:#000;
  overflow:hidden;
}
#background{
  position:fixed;
  inset:0;
  background:linear-gradient(to top,#0c2f3f,#000);
  z-index:-3;
}
.rain{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:-2;
}
.drop{
  position:absolute;
  width:2px;
  height:18px;
  background:rgba(255,255,255,0.35);
  animation:fall linear infinite;
}
@keyframes fall{
  to{transform:translateY(110vh);}
}

.container{
  max-width:850px;
  margin:40px auto;
  padding:32px;
  background:rgba(255,255,255,0.28);
  backdrop-filter:blur(14px);
  border-radius:22px;
  color:#000;
  text-align:center;
}
h1,h2{margin-bottom:12px}
p{line-height:1.7;font-size:1.05rem}

textarea{
  width:100%;
  height:120px;
  padding:14px;
  border-radius:14px;
  border:2px solid #7fd3e8;
  font-size:1rem;
  font-family:Nunito;
}
button{
  padding:12px 26px;
  margin:10px;
  border:none;
  border-radius:18px;
  background:#4a90e2;
  color:#fff;
  font-size:1rem;
  cursor:pointer;
}
.card{
  background:rgba(255,255,255,0.35);
  padding:22px;
  border-radius:20px;
  margin-top:18px;
}
.breath{
  width:190px;
  height:190px;
  border-radius:50%;
  background:radial-gradient(circle,#b3e5fc,#81d4fa);
  margin:22px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.4rem;
  font-weight:700;
  transition:2.5s;
}
.expand{transform:scale(1.75)}
.small{font-size:.95rem;opacity:.85}
</style>
</head>

<body>

<div id="background"></div>
<div class="rain" id="rain"></div>

<div class="container" id="app">
  <h1>üåø Calm Thinking</h1>
  <p>A quiet, supportive space to slow down and reconnect with yourself.</p>
  <button id="startBtn">Begin Session</button>
</div>

<audio id="ambience" loop src="https://www.orangefreesounds.com/wp-content/uploads/2016/04/Rainforest-sounds.mp3"></audio>

<script>
/* ---------- SETUP ---------- */
const app = document.getElementById("app");
const ambience = document.getElementById("ambience");
const rain = document.getElementById("rain");

let step = 0;
const reflections = [];

/* ---------- RAIN ---------- */
for(let i=0;i<140;i++){
  const d=document.createElement("div");
  d.className="drop";
  d.style.left=Math.random()*100+"%";
  d.style.animationDuration=(0.7+Math.random()*0.8)+"s";
  d.style.animationDelay=Math.random()*6+"s";
  rain.appendChild(d);
}

/* ---------- QUESTIONS ---------- */
const flow = [
  "What has been occupying your thoughts lately?",
  "What feels emotionally heavy right now?",
  "What part of this situation is outside your control?",
  "What part is still within your control?",
  "BREATH",
  "What is one kind thing you can offer yourself today?"
];

/* ---------- START ---------- */
startBtn.onclick = () => {
  ambience.volume = 0.45;
  ambience.play();
  renderStep();
};

/* ---------- TONE ---------- */
function analyzeTone(text){
  const t=text.toLowerCase();
  if(/overwhelmed|anxious|stressed|tired/.test(t)) return "stressed";
  if(/trying|learning|hope|healing/.test(t)) return "healing";
  if(/calm|okay|peace/.test(t)) return "calm";
  return "reflective";
}

/* ---------- FLOW ---------- */
function renderStep(){
  if(step >= flow.length){
    conclusion();
    return;
  }

  if(flow[step] === "BREATH"){
    breathing();
    return;
  }

  app.innerHTML = `
    <h2>${flow[step]}</h2>
    <textarea placeholder="There is no right or wrong answer. Just be honest."></textarea>
    <button>Continue</button>
  `;

  app.querySelector("button").onclick = () => {
    const text = app.querySelector("textarea").value.trim();
    if(!text){
      alert("Take your time. Even a few words are enough.");
      return;
    }
    const tone = analyzeTone(text);
    reflections.push({q:flow[step],text,tone});
    therapeuticReflection(tone);
  };
}

/* ---------- THERAPEUTIC EXERCISE ---------- */
function therapeuticReflection(tone){
  let prompt = "";
  if(tone==="stressed"){
    prompt="Gently rewrite one sentence from your response as if you were comforting a close friend.";
  }else if(tone==="healing"){
    prompt="Notice the effort you're making. What does that say about your resilience?";
  }else if(tone==="calm"){
    prompt="Pause and name what feels stable or supportive in this moment.";
  }else{
    prompt="Observe your thoughts without changing them. What do you notice?";
  }

  app.innerHTML = `
    <div class="card">
      <h3>üß† Gentle Reflection</h3>
      <p>${prompt}</p>
      <textarea placeholder="Write softly. No pressure."></textarea>
      <button>Continue</button>
    </div>
  `;

  app.querySelector("button").onclick = () => {
    step++;
    renderStep();
  };
}

/* ---------- BREATHING ---------- */
function breathing(){
  let phase=0;
  app.innerHTML = `
    <h2>üåå Guided Breathing</h2>
    <p class="small">Follow the rhythm. Nothing else to do.</p>
    <div class="breath" id="breath">Inhale</div>
    <button>Continue</button>
  `;
  const b=document.getElementById("breath");
  const timer=setInterval(()=>{
    if(phase===0){b.textContent="Inhale";b.classList.add("expand")}
    if(phase===1){b.textContent="Hold"}
    if(phase===2){b.textContent="Exhale";b.classList.remove("expand")}
    phase=(phase+1)%3;
  },2200);

  app.querySelector("button").onclick=()=>{
    clearInterval(timer);
    step++;
    renderStep();
  };
}

/* ---------- CONCLUSION ---------- */
function conclusion(){
  const quotes=[
    "You don‚Äôt have to control your thoughts. You just have to stop letting them control you.",
    "Healing is not linear. Be patient with yourself.",
    "Small steps taken gently still move you forward."
  ];
  const words=[
    {w:"Gentleness",m:"The quality of being kind, calm, and tender with yourself."},
    {w:"Resilience",m:"The ability to recover and continue, even when things feel heavy."},
    {w:"Presence",m:"Being fully here, without judging the moment."}
  ];
  const q=quotes[Math.floor(Math.random()*quotes.length)];
  const wd=words[Math.floor(Math.random()*words.length)];

  app.innerHTML = `
    <h2>üå± Session Complete</h2>
    <p>You showed up for yourself today. That matters.</p>

    <div class="card">
      <h3>üí¨ Quote of the Day</h3>
      <p><em>${q}</em></p>
    </div>

    <div class="card">
      <h3>üìñ Word of the Day</h3>
      <p><strong>${wd.w}</strong><br>${wd.m}</p>
    </div>

    <div class="card">
      <h3>‚ôüÔ∏è Board Games (Optional)</h3>
      <p>When you're ready for light mental engagement, board games can help gently refocus your mind.</p>
      <p class="small">(Coming soon ‚Äì always optional, never required.)</p>
    </div>

    <p class="small">Take a deep breath before returning to your day. You're doing the best you can.</p>
  `;
}
</script>
</body>
</html>
