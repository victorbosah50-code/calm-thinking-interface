<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calm Thinking Interface</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    margin: 0; padding: 0;
    display: flex; justify-content: center; align-items: center;
    min-height: 100vh;
    background: linear-gradient(135deg, #f0f4f8, #d9e2ec); /* Default gradient */
    transition: background 1s ease;
  }
  .container {
    max-width: 600px;
    width: 90%;
    background: rgba(255,255,255,0.85); /* Semi-transparent to show background */
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  h1 { margin-bottom: 10px; font-size: 1.4rem; }
  p { line-height: 1.5; }
  textarea {
    width: 100%;
    height: 100px;
    margin-top: 15px;
    font-size: 1rem;
    padding: 10px;
    resize: none;
  }
  button {
    margin-top: 20px;
    padding: 10px 16px;
    font-size: 1rem;
    cursor: pointer;
    border: none;
    border-radius: 6px;
    background-color: #4a90e2;
    color: white;
  }
  .footer { font-size: 0.8rem; color: #555; margin-top: 25px; }
  .summary { background-color: rgba(238,245,249,0.9); padding: 15px; border-radius: 8px; margin-top: 20px; white-space: pre-wrap; }
</style>
</head>
<body>
<div class="container">
  <h1 id="title">Welcome</h1>
  <p id="prompt">This is a calm thinking space. Take one slow breath before continuing.</p>
  <textarea id="input" placeholder="Type here..."></textarea>
  <button onclick="nextStep()">Continue</button>
  <div class="footer">
    This tool supports reflection only. No data is saved or tracked.
  </div>
</div>

<script>
// User state
let current = 0;
const responses = [];

// Mood template (gradient mapping)
const moodColors = {
  Calm: "linear-gradient(135deg, #a8edea, #fed6e3)",
  Neutral: "linear-gradient(135deg, #f0f4f8, #d9e2ec)",
  Stressed: "linear-gradient(135deg, #ff9a9e, #fecfef)",
  Thoughtful: "linear-gradient(135deg, #cfd9df, #e2ebf0)"
};

// Steps with reflection prompts
const steps = [
  { title: "Welcome", text: "This is a calm thinking space. Take one slow breath before continuing.", reflection: false },
  { title: "Focus", text: "What situation or decision is currently on your mind?", reflection: true, followup: "You’ve identified this as the current focus. Let’s explore it." },
  { title: "Facts", text: "What facts do you know for certain right now?", reflection: true, followup: "Noting facts helps clarify reality separate from assumptions." },
  { title: "Assumptions", text: "What are you assuming might be true?", reflection: true, followup: "Reflecting on assumptions can highlight uncertainties." },
  { title: "Control", text: "Which parts of this situation are within your control? Which are not?", reflection: true, followup: "Focusing on control areas can reduce stress." },
  { title: "Time", text: "If no action were taken for 24 hours, what would realistically change?", reflection: true, followup: "Considering time helps perspective and patience." },
  { title: "Next Step", text: "What is one small, non-urgent step you could take — or nothing at all?", reflection: true, followup: "Even a tiny step is progress." },
  { title: "Mood Selection", text: "Before we conclude, how are you feeling now? (Calm, Neutral, Stressed, Thoughtful)", reflection: false },
  { title: "Conclusion", text: "", reflection: false }
];

// Initial render
renderStep();

// Render function
function renderStep() {
  const step = steps[current];
  document.getElementById("title").innerText = step.title;
  document.getElementById("prompt").innerText = step.text;
  const inputArea = document.getElementById("input");

  if(step.title === "Conclusion") {
    inputArea.style.display = "none";
    document.querySelector("button").style.display = "none";
    showSummary();
    return;
  } else {
    inputArea.style.display = "block";
  }

  inputArea.value = "";
  inputArea.placeholder = step.title === "Mood Selection" ? "Type Calm, Neutral, Stressed, or Thoughtful" : "Type here...";
}

// Next step logic
function nextStep() {
  const step = steps[current];
  const userInput = document.getElementById("input").value.trim();

  if(step.reflection && userInput === "") {
    alert("Please type something before continuing.");
    return;
  }

  if(step.reflection) responses.push({ step: step.title, input: userInput });

  // Mood handling
  if(step.title === "Mood Selection") {
    const gradient = moodColors[userInput] || moodColors["Neutral"];
    document.body.style.background = gradient;
  }

  // Reflection acknowledgment
  if(step.reflection) {
    document.getElementById("prompt").innerText = step.followup;
    document.getElementById("input").value = "";
    document.querySelector("button").disabled = true;

    setTimeout(() => {
      document.querySelector("button").disabled = false;
      current++;
      renderStep();
    }, 4000); // 4-second pause
  } else {
    current++;
    renderStep();
  }
}

// Show conclusion summary
function showSummary() {
  const container = document.querySelector(".container");
  const summaryDiv = document.createElement("div");
  summaryDiv.className = "summary";

  let summaryText = "Session Summary:\n\n";
  responses.forEach(r => {
    summaryText += `${r.step}: ${r.input}\n`;
  });

  summaryText += "\nTakeaway: You clarified your thoughts, reflected on assumptions, focused on what you can control, and identified at least one small next step. Progress comes from small, intentional actions.";

  summaryDiv.innerText = summaryText;
  container.appendChild(summaryDiv);
}
</script>
</body>
</html>
