<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTFâ€‘8">
<meta name="viewport" content="width=deviceâ€‘width, initialâ€‘scale=1.0">
<title>ğŸŒ¿ Calm Thinking Interface ğŸŒ¿</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
<style>

/* == Background video */
#bgVideo {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  z-index: -2;
  opacity: 0.5;
}
body {
  margin: 0; padding: 0;
  width: 100%; height: 100%;
  font-family: 'Nunito', sans-serif;
  overflow: hidden;
  background: #000;
}

/* == Particle overlay */
#particleCanvas {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  zâ€‘index: -1;
  pointer-events: none;
}

/* == UI container */
.container {
  position: relative;
  zâ€‘index: 1;
  max-width: 700px;
  width: 90%;
  background: rgba(255,255,255,0.88);
  padding: 30px 40px;
  border-radius: 16px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
  text-align: center;
}

h1 {
  font-size: 2rem;
  margin-bottom: 22px;
  opacity: 0;
  animation: fadeBounce 1.5s forwards;
}
p { line-height: 1.6; font-size: 1.1rem; }

textarea {
  width: 100%;
  height: 100px;
  margin-top: 20px;
  font-size: 1rem;
  padding: 12px;
  resize: none;
  border-radius: 8px;
  border: 1px solid #bbb;
  transition: box-shadow 0.3s;
}
textarea:focus {
  outline: none;
  box-shadow: 0 0 12px #4a90e2;
}

button {
  margin-top: 18px;
  padding: 12px 20px;
  font-size: 1rem;
  cursor: pointer;
  border: none;
  border-radius: 8px;
  background-color: #4a90e2;
  color: white;
  transition: transform 0.2s, box-shadow 0.2s;
}
button:hover {
  transform: scale(1.07);
  box-shadow: 0 4px 15px rgba(74,144,226,0.4);
}

.footer { font-size: 0.8rem; color: #444; margin-top: 25px; }

.summary {
  background-color: rgba(255,255,255,0.96);
  padding: 28px;
  border-radius: 16px;
  margin-top: 25px;
  white-space: pre-wrap;
  font-size: 1rem;
  line-height: 1.7;
  opacity: 0;
  transition: opacity 1s;
}

@keyframes fadeBounce {
  0% { opacity: 0; transform: translateY(-20px);}
  50% { opacity: 1; transform: translateY(8px);}
  100% { opacity: 1; transform: translateY(0);}
}
</style>
</head>
<body>

<!-- -->  
<video autoplay muted loop id="bgVideo">
<!-- Replace the source URL below with a free CC0 nature video link before deployment -->
<source src="https://cdn.pixabay.com/videvo_files/video/free/2019/04/30/large_watermarked/190430_B_123_nature_lake_preview.mp4" type="video/mp4">
</video>

<canvas id="particleCanvas"></canvas>

<div class="container">
  <h1 id="title">ğŸŒ¿ Embrace Calm & Clarity ğŸŒ¿</h1>
  <p id="prompt">Take a deep breathâ€¦ youâ€™re entering a peaceful reflection space. Ready? ğŸ˜Š</p>
  <textarea id="input" placeholder="Begin typing..."></textarea>
  <button onclick="nextStep()">Next</button>
  
  <button id="backBtn" onclick="goBack()" style="display:none; margin-left:10px;">â¬…ï¸ Back</button>
  <button id="restartBtn" onclick="restartReflection()" style="display:none;">ğŸ”„ Restart</button>

  <div class="footer">
    This tool supports reflection only. No data is saved or tracked.
  </div>
</div>

<script>
// ===== Particle Overlay =====
const canvas = document.getElementById('particleCanvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function initParticles() {
  particles = [];
  for (let i=0; i<100; i++) {
    particles.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      r: Math.random()*2+1,
      dx: (Math.random()-0.5)*0.3,
      dy: (Math.random()-0.5)*0.3
    });
  }
}
initParticles();

function drawParticles() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for (let p of particles) {
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    ctx.fillStyle = "rgba(255,255,255,0.3)";
    ctx.fill();
    p.x += p.dx; p.y += p.dy;
    if(p.x<0) p.x=canvas.width;
    if(p.x>canvas.width) p.x=0;
    if(p.y<0) p.y=canvas.height;
    if(p.y>canvas.height) p.y=0;
  }
  requestAnimationFrame(drawParticles);
}
drawParticles();

// ===== Reflection Logic =====
let current = 0;
const responses = [];

const moodColors = {
  Calm: "linear-gradient(135deg, #a8edea, #fed6e3)",
  Neutral: "linear-gradient(135deg, #f0f4f8, #d9e2ec)",
  Stressed: "linear-gradient(135deg, #ff9a9e, #fecfef)",
  Thoughtful: "linear-gradient(135deg, #cfd9df, #e2ebf0)"
};

const steps = [
  { title:"Intro", text:"Take a moment to breathe and smile before we begin, type OKAY to begin.", reflection:false },
  { title:"Focus", text:"Whatâ€™s on your mind right now?", reflection:true, followup:"Got it â€” letâ€™s reflect more." },
  { title:"Facts", text:"What facts do you know for sure about it?", reflection:true, followup:"Facts ground your thinking." },
  { title:"Assumptions", text:"What might you be assuming?", reflection:true, followup:"Assumptions can be reframed." },
  { title:"Control", text:"Which parts are in your control?", reflection:true, followup:"Focus where you can influence." },
  { title:"Time", text:"If 24 hours passed with no action, what would change?", reflection:true, followup:"Time brings perspective." },
  { title:"Next Step", text:"One small non-urgent step you could take?", reflection:true, followup:"Small steps carry peace." },
  { title:"Mood", text:"How are you feeling now? (Calm, Neutral, Stressed, Thoughtful)", reflection:false },
  { title:"Conclusion", text:"", reflection:false }
];

function renderStep() {
  const step = steps[current];
  document.getElementById("title").innerText = step.title==="Intro" ? "ğŸŒ¿ Embrace Calm & Clarity ğŸŒ¿" : step.title;
  document.getElementById("prompt").innerText = step.text;
  const inputArea = document.getElementById("input");
  const backBtn = document.getElementById("backBtn");
  const restartBtn = document.getElementById("restartBtn");

  if(step.title==="Conclusion") {
    inputArea.style.display="none";
    document.querySelector("button[onclick='nextStep()']").style.display="none";
    backBtn.style.display="none";
    restartBtn.style.display="block";
    showSummary();
    return;
  }
  
  inputArea.style.display="block";
  document.querySelector("button[onclick='nextStep()']").style.display="inline-block";
  restartBtn.style.display="none";
  backBtn.style.display = current>0 ? "inline-block" : "none";

  inputArea.value="";
  inputArea.placeholder = step.title==="Mood"? "Calm, Neutral, Stressed, Thoughtful":"Type here...";
}

function nextStep() {
  const step = steps[current];
  const userInput = document.getElementById("input").value.trim();
  if(step.reflection && userInput==="") { alert("Type something to continue."); return; }
  if(step.reflection) responses.push({step:step.title,input:userInput});
  if(step.title==="Mood") {
    document.body.style.background = moodColors[userInput] || moodColors["Neutral"];
  }
  if(step.reflection) {
    document.getElementById("prompt").innerText = step.followup;
    document.getElementById("input").value="";
    document.querySelector("button[onclick='nextStep()']").disabled=true;
    setTimeout(()=>{ document.querySelector("button[onclick='nextStep()']").disabled=false; current++; renderStep(); },2500);
  } else { current++; renderStep(); }
}

function goBack() {
  if(current>0) { current--; responses.pop(); renderStep(); }
}

function restartReflection() {
  current=0; responses.length=0;
  document.querySelector(".summary")?.remove();
  renderStep();
}

function showSummary() {
  const container=document.querySelector(".container");
  const summary=document.createElement("div");
  summary.className="summary";
  container.appendChild(summary);

  const lines=[
    "ğŸŒˆ Your Reflection Journey ğŸŒˆ", "",
    ...responses.map(r=>`${r.step}: ${r.input}`), "",
    "ğŸ’– Breatheâ€¦ smileâ€¦ and feel peaceful! ğŸ’–",
    "You took the time to reflect, to see what you can control,",
    "and to find a gentle next step forward.",
    "You are calm, you are capable, and peace follows you.",
    "Thank you for being thoughtful â€” the world shines brighter with you. ğŸŒ¸ğŸ˜Š"
  ];

  let i=0;
  function animateLine() {
    if(i<lines.length) {
      summary.innerText += lines[i]+"\n";
      summary.style.opacity=1;
      i++;
      setTimeout(animateLine, 500);
    }
  }
  animateLine();
}

// Render initial step
renderStep();

</script>
</body>
</html>
